{
  "meta:license": [
    "Copyright 2019 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$id": "https://ns.adobe.com/experience/decisioning/proposition",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "title": "Decision Proposition",
  "type": "object",
  "meta:abstract": true,
  "meta:extensible": true,
  "description": "The  Decision Proposition XDM is used to capture the outcome of a decisioning process",
  "definitions": {
    "proposition-detail-datatype": {
      "properties": {
        "xdm:activity": {
          "title": "Decision Activity",
          "description": "Snapshot of the activity for which the proposition was made. The object contains at least the @id property value which is the URI of the decision activity. See schema https://ns.adobe.com/experience/decisioning/activity",
          "$ref": "https://ns.adobe.com/experience/decisioning/activity"
        },
        "xdm:selections": {
          "title": "Selected Options",
          "description": "Snapshots of the options that were selected for this activity. Those options are ususally constrained. The objects contain a at least the @id property value which is the URI of an option. See schema https://ns.adobe.com/experience/decisioning/option",
          "type": "array",
          "items": {
            "$ref": "https://ns.adobe.com/experience/decisioning/option"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "xdm:fallback": {
          "title": "Fallback Option",
          "description": "Snapshot of the fixed fallback option that was selected because no available option satisfied all constaints. The objects contain a at least the @id property value which is the URI of an option. See schema https://ns.adobe.com/experience/decisioning/option",
          "$ref": "https://ns.adobe.com/experience/decisioning/option"
        }
      }
    },
    "proposition-metrics-datatype": {
      "properties": {
        "xdm:metrics": {
          "title": "Metrics",
          "description": "Additional measurements observed while the decision was made and which provided context to the decision process.",
          "$ref": "https://ns.adobe.com/experience/decisioning/eventmetrics"
        }
      }
    },
    "propositions-mixin": {
      "meta:intendedToExtend": [
        "https://ns.adobe.com/xdm/context/experienceevent",
        "https://ns.adobe.com/experience/decisioning/decisionevent"
      ],
      "properties": {
        "https://ns.adobe.com/experience/decisioning/propositionId": {
          "title": "Decision Proposition ID",
          "type": "string",
          "description": "An ID associated with an individual decision response. A single decision can produce an array of propositions, one for each activity involved. It is the expectation that applications reference this ID in every experience event that was influended by the propositions. A user profile's proposition-response history is maintained with these identifiers."
        },
        "https://ns.adobe.com/experience/decisioning/propositionDetails": {
          "title": "Propopostion Array providing the outcomes of a single decision event, one outcome per given activity",
          "type": "array",
          "items": {
            "$ref": "https://ns.adobe.com/experience/decisioning/proposition#/definitions/proposition-detail-datatype"
          },
          "description": "Details about the individual context variables and outcomes for the decision."
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "https://ns.adobe.com/xdm/common/extensible#/definitions/@context"
    },
    {
      "$ref": "#/definitions/proposition-detail-datatype"
    },
    {
      "required": ["xdm:activity"]
    },
    {
      "oneOf": [
        {
          "required": ["xdm:selections"]
        },
        {
          "required": ["xdm:fallback"]
        }
      ]
    },
    {
      "$ref": "#/definitions/proposition-metrics-datatype"
    }
  ],
  "meta:status": "experimental"
}
