{
  "id": "campaign/Message.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Message",
  "type": "object",
  "description": "A message part of a campaign activity.\nA message is created for each `Person` targeted in a campaign activity. If a person\nis targeted twice within the same activity, two messages will be created.\n",
  "properties": {
    "id": {
      "type": "string"
    },
    "recipient": {
      "anyOf": [
        {
          "$ref": "../core/Reference.json"
        },
        {
          "$ref": "../core/Person.json"
        },
        {
          "$ref": "../core/Subscription.json"
        }
      ],
      "description": "The recipient of the message.\n\nThe recipient is not necessarily a person, it could also be a subscription\nfrom a mobile application.\n"
    },
    "delivery": {
      "anyOf": [
        {
          "$ref": "../core/Reference.json"
        },
        {
          "$ref": "../campaign/Delivery.json"
        }
      ],
      "description": "The campaign activity originating this message.\n"
    },
    "address": {
      "type": "string",
      "description": "Address used to deliver the message to the recipient.\nDepending on the channel, the `address` has a different format.\n\n  * `email`: an email address.\n  * `SMS`: a phone number.\n  * `directMail`: a postal address.\n",
      "maxLength": 255
    },
    "status": {
      "type": "string",
      "enum": [
        "excluded",
        "sent",
        "bounce",
        "nonDeliverable",
        "sendPending",
        "cancelled",
        "expired"
      ]
    },
    "quarantine": {
      "type": "boolean",
      "description": "Address moved to quarantine.\nThe quarantine is set to true when the message failed to deliver in a way\nthat indicates that no future messages will be deliverable either to this\naddress.\n",
      "default": false
    },
    "proofMember": {
      "type": "boolean",
      "description": "The recipient of this message is a member of the proof group for this campaign activity.",
      "default": false
    },
    "seedMember": {
      "type": "boolean",
      "description": "The recipient of this message is a member of a seed list for this campaign\nactivity.\n",
      "default": false
    },
    "controlGroupMember": {
      "type": "boolean",
      "description": "The recipient of this message is a member of a control group\nfor this campaign activity.\n\nMessages to control group members are not delivered.\n",
      "default": false
    },
    "testMember": {
      "type": "boolean",
      "description": "The recipient of this message is a member of a test group for this campaign activity.",
      "default": false
    },
    "size": {
      "type": "integer",
      "description": "Size in bytes of the message.\n\n* For e-mail, the `size` reflect the all MIME envelop of the message, including\nthe encoded attachments if any.\n* For SMS, the `size` relect the number of bytes necessary to deliver the message.\nIf that number is over 160 the message will be delivered over more than one SMS.\n",
      "minimum": 0,
      "format": "int32"
    },
    "scheduledAt": {
      "type": "string",
      "format": "date-time",
      "description": "The date and time the message is expected to be delivered."
    },
    "lastStatusDate": {
      "type": "string",
      "format": "date-time",
      "description": "Date of the last delivery status update for this message."
    },
    "variant": {
      "type": "string",
      "description": "A campaign activity can have multiple variants (French, English) but a\nmessage delivered to a recipient always contains one of them.\n\n> IMPORTANT: Using the mirror page, the recipient can switch from one\n  variant to another (ex: switch of the language).\n"
    },
    "IP": {
      "type": "string",
      "description": "Outbound IP address used to deliver the message."
    },
    "reason": {
      "type": "string",
      "description": "The reason why the message could/would not be delivered.",
      "enum": [
        "unknownUser",
        "invalidDomain",
        "unreachable",
        "disabled",
        "mailboxFull",
        "refused"
      ]
    },
    "reasonMessage": {
      "type": "string",
      "description": "Reason of message delivery failure when the status is `bounce` or `nonDeliverable`.\n"
    }
  },
  "required": [
    "id",
    "recipient",
    "delivery",
    "address",
    "status",
    "lastStatusDate"
  ]
}
