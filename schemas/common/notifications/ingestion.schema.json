{
   "meta:license":[
      "Copyright 2019 Adobe Systems Incorporated. All rights reserved.",
      "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
      "you may not use this file except in compliance with the License. You may obtain a copy",
      "of the License at https://creativecommons.org/licenses/by/4.0/"
   ],
   "$id":"https://ns.adobe.com/xdm/common/notifications/ingestion",
   "$schema":"http://json-schema.org/draft-06/schema#",
   "title":"Customer Notifications Event",
   "type":"object",
   "meta:extensible":false,
   "meta:abstract":false,
   "meta:auditable":true,
   "meta:extends":[
      "https://ns.adobe.com/xdm/data/record"
   ],
   "description":"Customer Notification Events for data ingestion processes.",
   "definitions":{
      "ingestion-notification":{
         "properties":{
            "xdm:eventtype":{
               "title":"Event Type",
               "description":"Event Type of customer notification",
               "enum":[
                  "dl_load_success",
                  "dl_load_failure",
                  "ps_load_success",
                  "ps_load_failure",
                  "ig_load_success",
                  "ig_load_failure"
               ]
            },
            "xdm:status":{
               "title":"Status",
               "type":"string",
               "description":"The current status of this ingestion process",
               "enum":[
                  "success",
                  "failure"
               ]
            },
            "xdm:id":{
               "title":"ID",
               "type":"string",
               "description":"ADLS Unique identifier of the batch"
            },
            "xdm:customerBatchId":{
               "title":"Customer Batch Identifier",
               "type":"string",
               "pattern":"^[0-9A-Za-z\\.\\-\\_/@]+$",
               "description":"An externally generated identifier for this ingestion."
            },
            "datasetId":{
               "title":"Dataset ID",
               "type":"string",
               "description":"Dataset ID of the batch."
            },
            "xdm:inputFormat":{
               "title":"Input File Format",
               "description":"Metadata describing the INGEST format of the data being loaded (e.g. Parquet, CSV, JSON).",
               "enum":[
                  "csv",
                  "parquet",
                  "json"
               ]
            },
            "xdm:imsOrg":{
               "description":"The owning IMS organization identifier.",
               "type":"string",
               "pattern":"^[0-9A-Za-z]*@[Aa]dobe[Oo]rg$"
            },
            "xdm:startTime":{
               "type":"integer",
               "description":"The Unix timestamp (in milliseconds) when the Batch processing action was started."
            },
            "xdm:completionTime":{
               "type":"integer",
               "description":"The Unix timestamp (in milliseconds) when the Batch processing action was completed. Completed - Started should yield the total processing time.",
               "maximum":14500000000000
            },
            "xdm:errors":{
               "type":"array",
               "description":"A list of problems encountered during this ingestion process.",
               "items":{
                  "type":"object",
                  "properties":{
                     "code":{
                        "type":"string",
                        "description":"An enumerated code that details the type of error encountered. This value should be understandable by the reader and writer and eventually allow for localized error message (and solution) descriptions."
                     },
                     "rows":{
                        "type":"array",
                        "description":"Indicates which rows exhibit this error. Could be a single number, or a hyphen-delimited range.",
                        "items":{
                           "type":"string",
                           "description":"Row or range of rows this error was encountered on."
                        }
                     },
                     "description":{
                        "type":"string",
                        "description":"A human-readable description of the error. This message may be transmitted to clients, but isn't meant for customer-facing UIS."
                     }
                  }
               }
            }
         }
      }
   },
   "allOf":[
      {
         "$ref":"https://ns.adobe.com/xdm/data/record"
      },
      {
         "$ref":"#/definitions/ingestion-notification"
      }
   ],
   "meta:status":"stabilizing"
}