{
  "meta:license":[
     "Copyright 2020 Adobe Systems Incorporated. All rights reserved.",
     "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
     "you may not use this file except in compliance with the License. You may obtain a copy",
     "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$id":"https://ns.adobe.com/xdm/datatypes/consent-preferences",
  "$schema":"http://json-schema.org/draft-06/schema#",
  "title":"Privacy/Marketing Preferences (Consent)",
  "description":"This schema captures privacy, personalization and marketing preferences (consents).",
  "type":"object",
  "meta:extensible":true,
  "meta:abstract":true,
  "definitions":{
    "consentValue": {
      "title": "Consent Value",
      "description": "The value of the specific privacy/consent preference.",
      "type": "string",
      "enum": [
        "yes",
        "no",
        "pending",
        "unknown",
        "not_applicable"
      ],
      "meta:enum": {
        "yes": "The user has explicitly opted in to this feature",
        "no": "The user has explicitly opted out of this feature",
        "pending": "Pending verification",
        "unknown":"Unknown",
        "not_applicable":"Not Applicable"
      }
    },
    "basisOfProcessing": {
      "title": "Basis Of Processing",
      "type": "string",
      "description": "Legal basis for collecting/processing data. Is user consent required?",
      "enum": [
        "consent",
        "legitimate_interest",
        "contract",
        "compliance",
        "vital_interest",
        "public_interest"
      ],
      "meta:enum": {
        "consent": "User Consent",
        "legitimate_interest": "Legitimate Interest",
        "contract": "Contract",
        "compliance": "Compliance with a Legal Obligation",
        "vital_interest": "Vital Interest of the Individual",
        "public_interest": "Public Interest"
      }
    },
    "timestamp": {
      "title": "Preference timestamp",
      "description": "Timestamp of this specific opt out or preference.",
      "type": "string",
      "format": "date-time"
    },
    "source": {
      "title": "Source of Consent",
      "description": "Through which feature/product/method did the user provide this consent value",
      "type": "string",
      "maxLength": 20
    },
    "consentOption": {
      "type": "object",
      "properties": {
        "xdm:choice": {
          "$ref": "#/definitions/consentValue"
        },
        "xdm:basisOfProcessing": {
          "$ref": "#/definitions/basisOfProcessing"
        },
        "xdm:timestamp": {
          "$ref": "#/definitions/timestamp"
        },
        "xdm:source": {
          "$ref": "#/definitions/source"
        }
      }
    },
    "marketingOption": {
      "type": "object",
      "properties": {
        "xdm:choice": {
          "$ref": "#/definitions/consentValue"
        },
        "xdm:basisOfProcessing": {
          "$ref": "#/definitions/basisOfProcessing"
        },
        "xdm:timestamp": {
          "$ref": "#/definitions/timestamp"
        },
        "xdm:source": {
          "$ref": "#/definitions/source"
        },
        "xdm:reason": {
          "title": "Opt out reason",
          "type": "string",
          "description": "Reason for opting out",
          "maxLength": 20
        }
      }
    },
    "consent-preferences": {
      "properties": {
        "xdm:privacyPreferences": {
          "title": "Privacy Preferences",
          "description": "Encapsulates data privacy preferences or consents.",
          "type": "object",
          "properties": {
            "xdm:dataCollection": {
              "title": "Data Collection",
              "description": "Data collection is permitted",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:sellData": {
              "title": "Sell Data",
              "description": "Selling of user's Data with/to 2nd or 3rd parties is permitted, such as in compliance with CCPA",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:shareData": {
              "title": "Share Data",
              "description": "Sharing of user's Data with/to 2nd or 3rd parties is permitted",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:anonymousAnalysis": {
              "title": "Anonymous Analysis",
              "description": "Data can be used for analysis that does not require the use of any type of ID (whether it can be tied to an individual or not)",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:pseudonymousAnalysis": {
              "title": "Pseudonymous Analysis",
              "description": "Data can be used for analysis that may include an ID that may or may not be tied to an actual person",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:deviceLinking": {
              "title": "Device Linking",
              "description": "Attempts to associate multiple devices used/owned by an individual/household/organization are permitted",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:useAdvertiserID": {
              "title": "Can Use Advertiser ID",
              "description": "The user's mobile advertiser ID, such as Apple's IDFA, can be used",
              "$ref": "#/definitions/consentOption"
            }
          }
        },
        "xdm:personalizationPreferences": {
          "title": "Personalization Preferences",
          "description": "User's Personalization Preferences",
          "type": "object",
          "properties": {
            "xdm:general": {
              "title": "General Personalization Preference",
              "description": "Is there consent for personalization, unless overridden by a specific personalization preference",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:content": {
              "title": "Personalize content",
              "description": "Allow personalization of the content on my site or in my apps",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:inAppMessages": {
              "title": "Personalize in-app messages",
              "description": "Allow personalization of messages displayed within my apps",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:offers": {
              "title": "Personalize Offers",
              "description": "Allow personalization of offers (my own ads) displayed on my site or in my app",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:email": {
              "title": "Personalize email",
              "description": "Allow personalization of emails sent to the user",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:physicalMail": {
              "title": "Personalize physical mail",
              "description": "Allow personalization of offers sent via traditional/physical mail",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:phoneCalls": {
              "title": "Personalize phone calls",
              "description": "Allow phone calls that we initiate to be personalized base on your interests/history",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:customerSupport": {
              "title": "Personalize customer support",
              "description": "Allow customer support to personalize responses/suggestions based on your interests/history",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:pushNotifications": {
              "title": "Personalize push notifications",
              "description": "Personalization of push notifications is permitted",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:sms": {
              "title": "Personalize SMS",
              "description": "Personalize text messages",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:inStore": {
              "title": "Personalize in-store",
              "description": "Personalize in-store experiences",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:inVehicle": {
              "title": "Personalize in-vehicle",
              "description": "Personalize in-vehicle experiences",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:inHome": {
              "title": "Personalize in-home",
              "description": "Personalize in-home experiences",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:iotDevices": {
              "title": "Personalize IoT Devices",
              "description": "Personalize interactions on IoT devices",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:socialMedia": {
              "title": "Personalize Social Media",
              "description": "Personalize interactions on Social Media sites/apps",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:thirdPartyOffers": {
              "title": "Personalize ",
              "description": "Personalize third-party offers/ads displayed on my site or in my app",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:thirdPartyContent": {
              "title": "Personalize ",
              "description": "Personalize third-party content displayed on my site or in my app",
              "$ref": "#/definitions/consentOption"
            },
            "xdm:advertising": {
              "title": "Personalize Ads",
              "description": "Personalize my business's ads on third-party sites/apps",
              "$ref": "#/definitions/consentOption"
            }
          }
        },
        "xdm:marketingPreferences": {
          "title": "Marketing Preferences",
          "description": "User's Direct Marketing Preferences",
          "type": "object",
          "properties": {
            "xdm:preferredChannel": {
              "title": "Preferred Channel",
              "description": "User's preferred channel for receiving communications",
              "type": "string",
              "enum": [
                "email",
                "pushNotifications",
                "inAppMessages",
                "sms",
                "phoneCalls",
                "physicalMail",
                "inVehicleMessages",
                "inHomeMessages",
                "iotMessages",
                "socialMedia",
                "other",
                "none",
                "unknown"
              ],
              "meta:enum": {
                "email": "email",
                "pushNotifications": "push notifications",
                "inAppMessages": "in-app messages",
                "sms": "sms (text messages)",
                "phoneCalls": "phone calls",
                "physicalMail": "physical mail",
                "inVehicleMessages": "in-vehicle messages",
                "inHomeMessages": "in-home messages",
                "iot": "IoT messages",
                "socialMedia": "social media",
                "other": "other (a non-standard channel)",
                "none": "none (user does not have a preferred channel)",
                "unknown": "unknown"
              }
            },
            "xdm:general": {
              "title": "General Direct Marketing Preference",
              "description": "Does user consent to Direct Marketing in general, unless overridden by specific choices",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:email": {
              "title": "Receive email",
              "description": "User is willing to be contacted via email",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:pushNotifications": {
              "title": "Receive push notifications",
              "description": "It is okay to send push notifications",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:inAppMessages": {
              "title": "Receive in-app messages",
              "description": "User has allowed messages to be shown within the company's apps",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:sms": {
              "title": "Receive SMS",
              "description": "It is okay to send text messages to the user",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:phoneCalls": {
              "title": "Receive phone calls",
              "description": "The company may contact the user with phone solicitations",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:physicalMail": {
              "title": "Receive physical mail",
              "description": "It is okay to send offers via traditional/physical mail.",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:inVehicleMessages": {
              "title": "Receive in-vehicle messages",
              "description": "It is okay to provide offers to the user via technology installed in their vehicle",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:inHomeMessages": {
              "title": "Receive in-home messages",
              "description": "It is okay to provide offers to the user via technology installed in their home",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:iotMessages": {
              "title": "Receive IoT messages",
              "description": "It is okay to present offers via less traditional types of connected devices",
              "$ref": "#/definitions/marketingOption"
            },
            "xdm:socialMedia": {
              "title": "Receive Social Media Messages",
              "description": "It is okay to direct messages to the user via their social media accounts",
              "$ref": "#/definitions/marketingOption"
            }
          }
        },
        "xdm:version": {
          "title": "Preferences Version",
          "description": "Version of the Privacy Preferences Standard",
          "type": "string",
          "pattern": "^[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{1,4}$",
          "default": "1.0.0"
        },
        "xdm:timestamp": {
          "title": "Consent Preferences timestamp",
          "description": "Timestamp of the complete set of user consent preferences",
          "type": "string",
          "format": "date-time"
        },
        "xdm:source": {
          "title": "Consent Preferences source",
          "description": "Source for the complete set of user consent preferences",
          "$ref": "#/definitions/source"
        },
        "xdm:sourceID": {
          "title": "?? Source ID",
          "description": "ID for user as defined by consent source",
          "type": "string",
          "maxLength": 20
        },
        "xdm:userCountry": {
          "title": "User Country/Region",
          "description": "ISO 3166 alpha2 country code or ISO 3166-2 country plus state/province code for use in helping to determine how to interpret consent values",
          "type": "string",
          "maxLength": 6,
          "pattern": "[A-Z]{2}(-[A-Z]{1,3}){0,1}"
        },
        "xdm:countrySource": {
          "title": "Country Source",
          "description": "Method used to determine the user's country",
          "type": "string",
          "enum": [
            "ip",
            "gps",
            "user_provided",
            "website_location",
            "inferred",
            "other"
          ],
          "meta:enum": {
            "ip": "IP Address",
            "gps": "Device GPS",
            "user_provided": "User Provided",
            "website_location": "Website location or eTLD",
            "inferred": "Inferred",
            "other": "Other"
          }
        }
      }
    }
  },
  "allOf":[
    {
      "$ref":"https://ns.adobe.com/xdm/common/extensible#/definitions/@context"
    },
    {
      "$ref": "#/definitions/consent-preferences"
    }
  ],
  "meta:status":"experimental"
}
